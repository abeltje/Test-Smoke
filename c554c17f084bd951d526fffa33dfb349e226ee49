Original patch by Johan Vromans
